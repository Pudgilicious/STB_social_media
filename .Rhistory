#https://help.memsource.com/hc/en-us/articles/115003461051-Google-Translate-API-Key
#https://translatepress.com/docs/automatic-translation/generate-google-api-key/
library(tidyverse)
library(googleLanguageR)
library(textcat)
library(stringi)
library(translateR)
library(yaml)
library(cld2)
df = read_csv("./qiongyou/20200114_qy_list.csv")
keys = read_yaml("./config_file.yml")
is.na(df$eng_name) & df$poi_is_english == 1
df$eng_name = ifelse(is.na(df$eng_name) & df$poi_is_english == 1, df$POI, df$eng_name)
google.dataset.out <- translate(dataset = df,
content.field = 'POI',
google.api.key = keys$General$google_translate_api,
source.lang = 'zh-CN',
target.lang = 'en')
is.na(google.dataset.out$eng_name)
google.dataset.out$is_translated = ifelse(is.na(google.dataset.out$eng_name), 1, 0)
#https://help.memsource.com/hc/en-us/articles/115003461051-Google-Translate-API-Key
#https://translatepress.com/docs/automatic-translation/generate-google-api-key/
library(tidyverse)
library(googleLanguageR)
library(textcat)
library(stringi)
library(translateR)
library(yaml)
library(cld2)
df = read_csv("./qiongyou/20200114_qy_list.csv")
keys = read_yaml("./config_file.yml")
# df$language = detect_language(df$POI)
#If eng_name is NA and POI is english name
df$eng_name_modified = ifelse(is.na(df$eng_name) & df$poi_is_english == 1, df$POI, df$eng_name)
google.dataset.out <- translate(dataset = df,
content.field = 'POI',
google.api.key = keys$General$google_translate_api,
source.lang = 'zh-CN',
target.lang = 'en')
google.dataset.out$is_translated = ifelse(is.na(google.dataset.out$eng_name_modified), 1, 0)
google.dataset.out$eng_name_modified = ifelse(is.na(google.dataset.out$eng_name_modified), google.dataset.out$translatedContent, google.dataset.out$eng_name_modified)
googl
!is.na(google.dataset.out$eng_name_modified)
sum(!is.na(google.dataset.out$eng_name_modified))
sum(is.na(google.dataset.out$eng_name_modified))
gsub("[^0-9.-]", "", google.dataset.out$num_reviews)
google.dataset.out$num_reviews = gsub("[^0-9.-]", "", google.dataset.out$num_reviews)
names(google.dataset.out)
names(df2) = c("POI_INDEX", "POI_CHINESE_NAME", "POI_RAW_NAME", "URL", "TOTAL_REVIEWS", "POI_CHINESE_NAME_IS_ENGLISH", "POI_NAME", "POI_CHINESE_NAME_TRANSLATED", "POI_NAME_IS_TRANSLATED", "WEBSITE_INDEX")
names(google.dataset.out) = c("POI_INDEX", "POI_CHINESE_NAME", "POI_RAW_NAME", "URL", "TOTAL_REVIEWS", "POI_CHINESE_NAME_IS_ENGLISH", "POI_NAME", "POI_CHINESE_NAME_TRANSLATED", "POI_NAME_IS_TRANSLATED", "WEBSITE_INDEX")
names(google.dataset.out)
google.dataset.out$WEBSITE_INDEX = 3
#POI_NAME is modified
names(google.dataset.out) = c("POI_INDEX", "POI_CHINESE_NAME", "POI_RAW_NAME", "URL", "TOTAL_REVIEWS", "POI_CHINESE_NAME_IS_ENGLISH", "POI_NAME", "POI_CHINESE_NAME_TRANSLATED", "POI_NAME_IS_TRANSLATED", "WEBSITE_INDEX")
filename = paste0("qiongyou",gsub("-","", Sys.Date()), "_TB_SOCIAL_QY_CRAWL_LIST.csv")
filename
filename = paste0("./qiongyou/",gsub("-","", Sys.Date()), "_TB_SOCIAL_QY_CRAWL_LIST.csv")
filename
write.csv(google.dataset.out, filename, row.names = F)
library(cld2)
df = read_csv("./mafengwo/20200112_mfw_list.csv")
keys = read_yaml("./api_keys.yml")
df = read_csv("./mafengwo/20200112_mfw_list.csv")
getwd()
df = read_csv("./mafengwo/20200122_mfw_list")
list.files()
list.files("./mafengwo")
df = read_csv("./mafengwo/20200122_mfw_list.csv")
#https://help.memsource.com/hc/en-us/articles/115003461051-Google-Translate-API-Key
#https://translatepress.com/docs/automatic-translation/generate-google-api-key/
library(tidyverse)
library(googleLanguageR)
library(textcat)
library(stringi)
library(translateR)
library(yaml)
library(cld2)
df = read_csv("./mafengwo/20200122_mfw_list.csv")
keys = read_yaml("./api_keys.yml")
names(df)
View(df)
#https://help.memsource.com/hc/en-us/articles/115003461051-Google-Translate-API-Key
#https://translatepress.com/docs/automatic-translation/generate-google-api-key/
library(tidyverse)
library(googleLanguageR)
library(textcat)
library(stringi)
library(translateR)
library(yaml)
library(cld2)
df = read_csv("./mafengwo/20200122_mfw_list.csv")
keys = read_yaml("./api_keys.yml")
df$eng_name_modified = ifelse(is.na(df$eng_name) & df$poi_is_english == 1, df$POI, df$eng_name)
df$eng_name
df$poi_is_english
df$eng_name_modified = ifelse(is.na(df$eng_name) & df$poi_is_english == 1, df$cn_names, df$eng_name)
google.dataset.out <- translate(dataset = df,
content.field = 'cn_names',
google.api.key = keys$General$google_translate_api,
source.lang = 'zh-CN',
target.lang = 'en')
google.dataset.out$is_translated = ifelse(is.na(google.dataset.out$eng_name_modified), 1, 0)
google.dataset.out$eng_name_modified = ifelse(is.na(google.dataset.out$eng_name_modified), google.dataset.out$translatedContent, google.dataset.out$eng_name_modified)
google.dataset.out$num_reviews = gsub("[^0-9.-]", "", google.dataset.out$num_reviews)
google.dataset.out$WEBSITE_INDEX = 3
View(google.dataset.out)
names(google.dataset.out)
google.dataset.out = google.dataset.out[, -1]
names(google.dataset.out) = c("POI_INDEX", "URL", "POI_RAW_NAME", "POI_CHINESE_NAME", "TOTAL_REVIEWS", "POI_CHINESE_NAME_IS_ENGLISH", "POI_NAME", "POI_CHINESE_NAME_TRANSLATED", "POI_NAME_IS_TRANSLATED", "WEBSITE_INDEX")
filename = paste0("./mafengwo/",gsub("-","", Sys.Date()), "_TB_SOCIAL_MFW_CRAWL_LIST.csv")
write.csv(google.dataset.out, filename, row.names = F)
library(tidyverse)
library(googleLanguageR)
library(textcat)
library(stringi)
library(translateR)
library(yaml)
library(cld2)
df = read_csv("./qiongyou/20200114_qy_list.csv")
keys = read_yaml("./api_keys.yml")
View(df)
detect_language(df$POI)
#https://help.memsource.com/hc/en-us/articles/115003461051-Google-Translate-API-Key
#https://translatepress.com/docs/automatic-translation/generate-google-api-key/
library(tidyverse)
library(googleLanguageR)
library(textcat)
library(stringi)
library(translateR)
library(yaml)
library(cld2)
df = read_csv("./qiongyou/20200114_qy_list.csv")
keys = read_yaml("./api_keys.yml")
View(df)
detect_language(df$POI)
google.dataset.out <- translate(dataset = df,
content.field = 'POI',
google.api.key = keys$General$google_translate_api,
source.lang = 'zh-TW',
target.lang = 'zh-CN')
View(google.dataset.out)
google.dataset.out$POI = google.dataset.out$translatedContent
names(google.dataset.out)
google.dataset.out = google.dataset.out[, -which(names(google.dataset.out) == "translatedContent")]
google.dataset.out
google.dataset.out <- translate(dataset = google.dataset.out,
content.field = 'POI',
google.api.key = keys$General$google_translate_api,
source.lang = 'zh-CN',
target.lang = 'en')
google.dataset.out$is_translated = ifelse(is.na(google.dataset.out$eng_name_modified), 1, 0)
google.dataset.out$eng_name_modified = ifelse(is.na(google.dataset.out$eng_name_modified), google.dataset.out$translatedContent, google.dataset.out$eng_name_modified)
google.dataset.out$num_reviews = gsub("[^0-9.-]", "", google.dataset.out$num_reviews)
google.dataset.out$WEBSITE_INDEX = 4
names(google.dataset.out)
names(google.dataset.out) = c("POI_INDEX", "POI_CHINESE_NAME", "POI_RAW_NAME", "URL", "TOTAL_REVIEWS", "POI_CHINESE_NAME_IS_ENGLISH", "POI_NAME", "POI_CHINESE_NAME_TRANSLATED", "POI_NAME_IS_TRANSLATED", "WEBSITE_INDEX")
library(tidyverse)
library(googleLanguageR)
library(textcat)
library(stringi)
library(translateR)
library(yaml)
library(cld2)
df = read_csv("./qiongyou/20200114_qy_list.csv")
keys = read_yaml("./api_keys.yml")
# df$language = detect_language(df$POI)
#If eng_name is NA and POI is english name
df$eng_name_modified = ifelse(is.na(df$eng_name) & df$poi_is_english == 1, df$POI, df$eng_name)
google.dataset.out <- translate(dataset = df,
content.field = 'POI',
google.api.key = keys$General$google_translate_api,
source.lang = 'zh-TW',
target.lang = 'zh-CN')
google.dataset.out$POI = google.dataset.out$translatedContent
google.dataset.out = google.dataset.out[, -which(names(google.dataset.out) == "translatedContent")]
google.dataset.out <- translate(dataset = google.dataset.out,
content.field = 'POI',
google.api.key = keys$General$google_translate_api,
source.lang = 'zh-CN',
target.lang = 'en')
google.dataset.out$is_translated = ifelse(is.na(google.dataset.out$eng_name_modified), 1, 0)
google.dataset.out$eng_name_modified = ifelse(is.na(google.dataset.out$eng_name_modified), google.dataset.out$translatedContent, google.dataset.out$eng_name_modified)
google.dataset.out$num_reviews = gsub("[^0-9.-]", "", google.dataset.out$num_reviews)
google.dataset.out$WEBSITE_INDEX = 4
names(google.dataset.out) = c("POI_INDEX", "POI_CHINESE_NAME", "POI_RAW_NAME", "URL", "TOTAL_REVIEWS", "POI_CHINESE_NAME_IS_ENGLISH", "POI_NAME", "POI_CHINESE_NAME_TRANSLATED", "POI_NAME_IS_TRANSLATED", "WEBSITE_INDEX")
filename = paste0("./qiongyou/",gsub("-","", Sys.Date()), "_TB_SOCIAL_QY_CRAWL_LIST.csv")
write.csv(google.dataset.out, filename, row.names = F)
