knitr::opts_knit$set(root.dir = "~/git/STB_social_media_analytics")
knitr::opts_chunk$set(root.dir = "~/git/STB_social_media_analytics", echo = TRUE)
library(dplyr)
library(wordcloud)
library(tm)
library(stopwords)
# Read reviews CSVs in this chunk
tripa_path <- "./tripadvisor/finalised_output/"
folders <- list.files(path = tripa_path, include.dirs = TRUE)
col_names <- c(
"REVIEW_INDEX",
"WEBSITE_INDEX",
"POI_INDEX",
"REVIEWER_URL",
"REVIEW_ID",
"REVIEW_DATE",
"REVIEW_RATING",
"REVIEW_TITLE",
"REVIEW_BODY",
"DATE_OF_EXPERIENCE",
"TRIP_TYPE",
"REVIEW_CRAWLED_TIME"
)
tripa_df <- data.frame(matrix(nrow = 0, ncol = 12))
names(tripa_df) <- col_names
for (folder in folders) {
path <- paste0(tripa_path, folder, "/reviews/")
csv_files <- list.files(path = path)
for (csv_file in csv_files) {
csv_path <- paste0(path, csv_file)
poi_df <- read.csv(csv_path, as.is = TRUE)
tripa_df <- rbind(tripa_df, poi_df)
}
}
summary(tripa_df)
text <- paste(tripa_df$REVIEW_TITLE, collapse = " ")
docs <- Corpus(VectorSource(text))
docs <- docs %>%
tm_map(removeNumbers) %>%
tm_map(removePunctuation) %>%
tm_map(stripWhitespace)
docs <- tm_map(docs, content_transformer(tolower))
# docs <- tm_map(docs, removeWords, stopwords("english")) # Takes to long to run
tdm <- TermDocumentMatrix(docs)
tdm_matrix <- as.matrix(tdm)
words <- sort(rowSums(tdm_matrix), decreasing = TRUE)
words_df <- data.frame(word = names(words), freq = words)
stopwords <- stopwords()
words_df <- subset(words_df, !(word %in% stopwords))
words_df
set.seed(2678) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 100, random.order = FALSE, rot.per = 0.5, colors = brewer.pal(8, "Dark2"))
text <- paste(tripa_df$REVIEW_BODY, collapse = " ")
docs <- Corpus(VectorSource(text))
docs <- docs %>%
tm_map(removeNumbers) %>%
tm_map(removePunctuation) %>%
tm_map(stripWhitespace)
docs <- tm_map(docs, content_transformer(tolower))
# docs <- tm_map(docs, removeWords, stopwords("english")) # Takes to long to run
tdm <- TermDocumentMatrix(docs)
tdm_matrix <- as.matrix(tdm)
words <- sort(rowSums(tdm_matrix), decreasing = TRUE)
words_df <- data.frame(word = names(words), freq = words)
stopwords <- stopwords()
words_df <- subset(words_df, !(word %in% stopwords))
words_df
set.seed(2678) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 100, random.order = FALSE, rot.per = 0.5, colors = brewer.pal(8, "Dark2"))
set.seed(2678) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 50, random.order = FALSE, rot.per = 0.5, colors = brewer.pal(8, "Dark2"))
set.seed(2678) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 75, random.order = FALSE, rot.per = 0.5, colors = brewer.pal(8, "Dark2"))
set.seed(2678) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 80, random.order = FALSE, rot.per = 0.5, colors = brewer.pal(8, "Dark2"))
set.seed(2678) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 90, random.order = FALSE, rot.per = 0.5, colors = brewer.pal(8, "Dark2"))
set.seed(2678) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 80, random.order = FALSE, rot.per = 0.5, colors = brewer.pal(8, "Dark2"))
set.seed(34978) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 80, random.order = FALSE, rot.per = 0.5, colors = brewer.pal(8, "Dark2"))
set.seed(34978) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 75, random.order = FALSE, rot.per = 0.5, colors = brewer.pal(8, "Dark2"))
set.seed(455) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 75, random.order = FALSE, rot.per = 0.5, colors = brewer.pal(8, "Dark2"))
set.seed(455) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 80, random.order = FALSE, rot.per = 0.5, colors = brewer.pal(8, "Dark2"))
set.seed(674239) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 80, random.order = FALSE, rot.per = 0.5, colors = brewer.pal(8, "Dark2"))
set.seed(1234) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 80, random.order = FALSE, rot.per = 0.5, colors = brewer.pal(8, "Dark2"))
set.seed(1234) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 80, random.order = FALSE, rot.per = 0.3, colors = brewer.pal(8, "Dark2"))
set.seed(1234) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 80, random.order = FALSE, rot.per = 0.1, colors = brewer.pal(8, "Dark2"))
set.seed(1234) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 80, random.order = FALSE, rot.per = 0, colors = brewer.pal(8, "Dark2"))
set.seed(1234) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 50, random.order = FALSE, rot.per = 0, colors = brewer.pal(8, "Dark2"))
set.seed(1234) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 75, random.order = FALSE, rot.per = 0, colors = brewer.pal(8, "Dark2"))
set.seed(1234) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 75, random.order = FALSE, rot.per = 0, colors = brewer.pal(8, "Dark2"), scale=c(3.5,0.25))
set.seed(1234) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 200, random.order = FALSE, rot.per = 0, colors = brewer.pal(8, "Dark2"), scale=c(3.5,0.25))
set.seed(1234) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 200, random.order = FALSE, rot.per = 0.35, colors = brewer.pal(8, "Dark2"), scale=c(3.5,0.25))
set.seed(1) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 200, random.order = FALSE, rot.per = 0.35, colors = brewer.pal(8, "Dark2"), scale=c(3.5,0.25))
set.seed(1) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 200, random.order = FALSE, rot.per = 0.35, colors = brewer.pal(8, "Dark2"), scale=c(1,0.25))
set.seed(1) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 200, random.order = FALSE, rot.per = 0.35, colors = brewer.pal(8, "Dark2"), scale=c(5,0.25))
set.seed(1) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 200, random.order = FALSE, rot.per = 0.35, colors = brewer.pal(8, "Dark2"), scale=c(3,0.25))
set.seed(1) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 200, random.order = FALSE, rot.per = 0.35, colors = brewer.pal(8, "Dark2"), scale=c(3,0.5))
set.seed(1) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 200, random.order = FALSE, rot.per = 0.35, colors = brewer.pal(8, "Dark2"), scale=c(3, 1))
set.seed(1) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 200, random.order = FALSE, rot.per = 0.35, colors = brewer.pal(8, "Dark2"), scale=c(3, 0.2))
set.seed(1) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 200, random.order = FALSE, rot.per = 0.35, colors = brewer.pal(8, "Dark2"), scale=c(3, 0.1))
set.seed(1) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 500, random.order = FALSE, rot.per = 0.35, colors = brewer.pal(8, "Dark2"), scale=c(3, 0.1))
set.seed(1) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 500, random.order = FALSE, rot.per = 0.35, colors = brewer.pal(8, "Dark2"), scale=c(2, 0.1))
set.seed(1) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 500, random.order = FALSE, rot.per = 0.35, colors = brewer.pal(8, "Dark2"), scale=c(4, 0.1))
set.seed(1) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 500, random.order = FALSE, rot.per = 0.35, colors = brewer.pal(8, "Dark2"), scale=c(5, 0.1))
set.seed(1) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 500, random.order = FALSE, rot.per = 0.35, colors = brewer.pal(8, "Dark2"), scale=c(4.5, 0.1))
set.seed(1) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 500, random.order = FALSE, rot.per = 0.35, colors = brewer.pal(8, "Dark2"), scale=c(4, 0.2))
set.seed(1) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 500, random.order = FALSE, rot.per = 0.35, colors = brewer.pal(8, "Dark2"), scale=c(4, 0.1))
set.seed(1) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 500, random.order = FALSE, rot.per = 0, colors = brewer.pal(8, "Dark2"), scale=c(4, 0.1))
words_df = subset(words_df, !(word %in% c("singapore", "can")))
set.seed(1) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 500, random.order = FALSE, rot.per = 0, colors = brewer.pal(8, "Dark2"), scale=c(4, 0.1))
set.seed(1) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 300, random.order = FALSE, rot.per = 0, colors = brewer.pal(8, "Dark2"), scale=c(4, 0.1))
set.seed(1) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 250, random.order = FALSE, rot.per = 0, colors = brewer.pal(8, "Dark2"), scale=c(4, 0.1))
set.seed(1) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 400, random.order = FALSE, rot.per = 0, colors = brewer.pal(8, "Dark2"), scale=c(4, 0.1))
library(dplyr)
library(tm)
library(stopwords)
library(wordcloud)
library(wordcloud2)
library(dplyr)
library(tm)
library(stopwords)
library(wordcloud)
library(wordcloud2)
wordcloud2(data=words_df, size=1.6, color='random-dark')
set.seed(1) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 300, random.order = FALSE, rot.per = 0, colors = brewer.pal(8, "Dark2"), scale=c(4, 0.1))
set.seed(1) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 350, random.order = FALSE, rot.per = 0, colors = brewer.pal(8, "Dark2"), scale=c(4, 0.1))
stopwords <- stopwords()
words_df <- subset(words_df, !(word %in% stopwords))
words_df
words_df <- data.frame(word = names(words), freq = words)
stopwords <- stopwords()
words_df <- subset(words_df, !(word %in% stopwords))
words_df
set.seed(1) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 325, random.order = FALSE, rot.per = 0, colors = brewer.pal(8, "Dark2"), scale=c(4, 0.1))
set.seed(1) # for reproducibility
wordcloud(words = words_df$word, freq = words_df$freq, min.freq = 1, max.words = 300, random.order = FALSE, rot.per = 0, colors = brewer.pal(8, "Dark2"), scale=c(4, 0.1))
wordcloud2(data=words_df, size=1.6, color='random-dark')
wordcloud2(data=words_df$word, size=1.6, color='random-dark')
wordcloud2(data=words_df$words, size=1.6, color='random-dark')
wordcloud2(data=(words_df$word), size=1.6, color='random-dark')
wordcloud2(data=words_df, size=1.6, color='random-dark')
